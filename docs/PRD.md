# 제품 요구사항 문서 (PRD) - MVP

## 1. 개요
- **제품명**: PDF to EPUB Converter
- **MVP 목표**: Supabase와 React, FastAPI를 기반으로 PDF를 EPUB으로 변환하는 핵심 기능을 제공하는 웹 애플리케이션. 특히 한국어 OCR 처리에 중점을 둔다.

## 2. 사용자 시나리오
1.  **일반 사용자**: 웹사이트에 접속하여 PDF 파일을 업로드하고, 몇 번의 클릭만으로 변환된 EPUB 파일을 다운로드받고 싶어 한다.
2.  **연구원/학생**: 스캔된 논문이나 자료를 전자책 뷰어에서 읽고 검색하기 위해 텍스트가 추출된 EPUB 파일이 필요하다.

## 3. 핵심 기능 요구사항 (Features)

| ID | 기능 설명 | 우선순위 | 비고 |
| :--- | :--- | :--- | :--- |
| FEAT-01 | **사용자 인증** | ★★★ | Supabase Auth (이메일/비밀번호)를 통한 회원가입 및 로그인 | 
| FEAT-02 | **PDF 파일 업로드** | ★★★ | Supabase Storage에 직접 업로드, 드래그 앤 드롭 지원 | 
| FEAT-03 | **텍스트 기반 PDF 변환** | ★★★ | PDF 내 텍스트와 이미지를 추출하여 EPUB으로 재구성 | 
| FEAT-04 | **스캔 기반 PDF 변환 (OCR)** | ★★★ | PaddleOCR을 사용하여 이미지 내 한국어/영문 텍스트 인식 및 추출 | 
| FEAT-05 | **실시간 변환 상태 추적** | ★★★ | Supabase Realtime을 통해 '대기중', '처리중', '완료', '실패' 상태를 UI에 표시 | 
| FEAT-06 | **결과 파일 다운로드** | ★★★ | 변환 완료 후 Supabase Storage에 저장된 EPUB 파일 다운로드 링크 제공 | 
| FEAT-07 | **변환 내역 조회** | ★★☆ | 사용자가 자신이 변환했던 작업 목록을 조회할 수 있는 기능 | 
| FEAT-08 | **다국어 지원 (i18n)** | ★★☆ | UI(한/영) 및 OCR 언어(한/영) 선택 기능 제공 | 

## 4. 기능 명세 (Functional Specifications)

### 4.1. PDF 처리 모듈 (FastAPI)
- **입력**: Supabase Storage에 저장된 PDF 파일의 URL.
- **처리 과정**:
    1.  PDF 파일을 분석하여 텍스트 레이어 존재 여부 확인.
    2.  **텍스트 기반**: PyPDF2/pdfminer.six를 사용하여 텍스트와 이미지를 순서대로 추출.
    3.  **스캔 기반**: 페이지를 이미지로 변환 후 PaddleOCR을 호출하여 텍스트 추출.
- **출력**: 구조화된 텍스트 및 이미지 데이터.

### 4.2. EPUB 생성 모듈 (FastAPI)
- **입력**: 구조화된 텍스트 및 이미지 데이터.
- **처리 과정**:
    1.  ebooklib을 사용하여 EPUB3 표준 구조 생성.
    2.  추출된 콘텐츠를 XHTML 챕터로 삽입.
    3.  PDF 메타데이터(제목, 저자)가 있다면 EPUB 메타데이터로 반영.
- **출력**: 생성된 EPUB 파일을 Supabase Storage에 업로드.

### 4.3. API 엔드포인트 (FastAPI)
- `POST /convert`: Supabase Edge Function으로부터 호출되는 내부 엔드포인트. 변환 작업을 수행.
    - **Request Body**: `{ "job_id": "uuid", "pdf_url": "string" }`
    - **Response**: `{ "status": "success" }` 또는 에러.

### 4.4. 웹 프론트엔드 (React)
- **주요 컴포넌트**: 로그인/회원가입 폼, 파일 업로드 영역, 변환 작업 목록, 상태 표시기.
- **핵심 로직**:
    - `supabase-js`를 사용하여 인증, 스토리지, 데이터베이스와 직접 통신.
    - 파일 업로드 시 `conversion_jobs` 테이블에 레코드 생성.
    - 테이블 변경 사항을 실시간으로 구독하여 UI 업데이트.

## 5. 비기능 요구사항
- **성능**: 30MB 이하, 100페이지 미만 PDF를 1분 내외로 변환 완료.
- **UI/UX**: `ui_spec.md`에 정의된 대로 직관적이고 반응형 디자인을 제공.
- **보안**: Supabase RLS 정책을 통해 사용자는 자신의 데이터에만 접근 가능.
- **언어**: Python 3.12+, React 18+, TypeScript.

## 6. 성공 지표
- **핵심 성공 지표**: 사용자가 웹 앱을 통해 PDF를 성공적으로 업로드하고 변환된 EPUB을 다운로드받을 수 있다.
- **OCR 정확도**: 한국어 스캔 문서 기준, 주요 단어 인식률 95% 이상.
- **변환 성공률**: 전체 변환 요청 중 98% 이상 성공 (네트워크 등 외부 요인 제외).